---
apiVersion: apps/v1
items:
- metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2022-12-21T07:28:20Z"
    generation: 1
    labels:
      app: ubuntu
      pod-template-hash: 7b8975b5d6
      security.istio.io/tlsMode: istio
      service.istio.io/canonical-name: ubuntu
      service.istio.io/canonical-revision: latest
    name: ubuntu-deployment-7b8975b5d6
    namespace: vl3-test
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: ubuntu-deployment
      uid: 29620e41-bc1c-46c5-aafa-cc229c5e4e5e
    resourceVersion: "19117"
    uid: 188a653e-8a04-41ff-be60-ac7e9a7c9111
  spec:
    replicas: 1
    selector:
      matchLabels:
        app: ubuntu
        pod-template-hash: 7b8975b5d6
    template:
      metadata:
        annotations:
          kubectl.kubernetes.io/default-container: ubuntu
          kubectl.kubernetes.io/default-logs-container: ubuntu
          networkservicemesh.io: kernel://my-vl3-network/nsm-1?dnsName=ubuntu
          prometheus.io/path: /stats/prometheus
          prometheus.io/port: "15020"
          prometheus.io/scrape: "true"
          sidecar.istio.io/status: '{"initContainers":["istio-init"],"containers":["istio-proxy"],"volumes":["workload-socket","credential-socket","workload-certs","istio-envoy","istio-data","istio-podinfo","istio-token","istiod-ca-cert"],"imagePullSecrets":null,"revision":"default"}'
        creationTimestamp: null
        labels:
          app: ubuntu
          pod-template-hash: 7b8975b5d6
          security.istio.io/tlsMode: istio
          service.istio.io/canonical-name: ubuntu
          service.istio.io/canonical-revision: latest
      spec:
        containers:
        - command:
          - sleep
          - "123456"
          image: ubuntu
          imagePullPolicy: Always
          name: ubuntu
          resources: {}
          securityContext:
            privileged: true
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
        - args:
          - proxy
          - sidecar
          - --domain
          - ""
          - --proxyLogLevel=warning
          - --proxyComponentLogLevel=misc:error
          - --log_output_level=default:info
          - --concurrency
          - "2"
          env:
          - name: JWT_POLICY
            value: third-party-jwt
          - name: PILOT_CERT_PROVIDER
            value: istiod
          - name: CA_ADDR
            value: istiod.istio-system.svc:15012
          - name: POD_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: POD_NAMESPACE
            value: vm-ns
          - name: INSTANCE_IP
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: status.podIP
          - name: SERVICE_ACCOUNT
            value: serviceaccountvm
          - name: HOST_IP
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: status.hostIP
          - name: PROXY_CONFIG
            value: |
              {}
          - name: ISTIO_META_POD_PORTS
            value: |-
              [
              ]
          - name: ISTIO_META_APP_CONTAINERS
            value: ubuntu
          - name: ISTIO_META_CLUSTER_ID
            value: Kubernetes
          - name: ISTIO_META_INTERCEPTION_MODE
            value: REDIRECT
          - name: ISTIO_META_MESH_ID
            value: cluster.local
          - name: TRUST_DOMAIN
            value: cluster.local
          image: docker.io/istio/proxyv2:1.16.0
          imagePullPolicy: IfNotPresent
          name: istio-proxy
          ports:
          - containerPort: 15090
            name: http-envoy-prom
            protocol: TCP
          readinessProbe:
            failureThreshold: 30
            httpGet:
              path: /healthz/ready
              port: 15021
              scheme: HTTP
            initialDelaySeconds: 1
            periodSeconds: 2
            successThreshold: 1
            timeoutSeconds: 3
          resources:
            limits:
              cpu: "2"
              memory: 1Gi
            requests:
              cpu: 100m
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: true
            runAsGroup: 1337
            runAsNonRoot: true
            runAsUser: 1337
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /var/run/secrets/istio/root-cert.pem
            name: cert
            subPath: root-cert.pem
          - mountPath: /var/lib/istio/envoy/cluster.env
            name: cert
            subPath: cluster.env
          - mountPath: /etc/istio/config/mesh
            name: cert
            subPath: mesh.yaml
          - mountPath: /var/run/secrets/tokens/istio-token
            name: cert
            subPath: istio-token
          - mountPath: /var/run/secrets/workload-spiffe-uds
            name: workload-socket
          - mountPath: /var/run/secrets/credential-uds
            name: credential-socket
          - mountPath: /var/run/secrets/workload-spiffe-credentials
            name: workload-certs
          - mountPath: /var/lib/istio/data
            name: istio-data
          - mountPath: /etc/istio/proxy
            name: istio-envoy
        dnsPolicy: ClusterFirst
        initContainers:
        - args:
          - istio-iptables
          - -p
          - "15001"
          - -z
          - "15006"
          - -u
          - "1337"
          - -m
          - REDIRECT
          - -i
          - '*'
          - -x
          - ""
          - -b
          - '*'
          - -d
          - 15090,15021,15020
          - --log_output_level=default:info
          image: docker.io/istio/proxyv2:1.16.0
          imagePullPolicy: IfNotPresent
          name: istio-init
          resources:
            limits:
              cpu: "2"
              memory: 1Gi
            requests:
              cpu: 100m
              memory: 128Mi
          securityContext:
            allowPrivilegeEscalation: false
            capabilities:
              add:
              - NET_ADMIN
              - NET_RAW
              drop:
              - ALL
            privileged: false
            readOnlyRootFilesystem: false
            runAsGroup: 0
            runAsNonRoot: false
            runAsUser: 0
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
        volumes:
        - configMap:
            defaultMode: 420
            name: cert-file
          name: cert
        - emptyDir: {}
          name: workload-socket
        - emptyDir: {}
          name: credential-socket
        - emptyDir: {}
          name: workload-certs
        - emptyDir:
            medium: Memory
          name: istio-envoy
        - emptyDir: {}
          name: istio-data
  status:
    fullyLabeledReplicas: 1
    observedGeneration: 1
    replicas: 1
kind: ReplicaSetList
metadata:
  resourceVersion: "19319"
