---
apiVersion: apps/v1
items:
- metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2022-12-21T23:41:10Z"
    generation: 1
    labels:
      app: admission-webhook-k8s
      pod-template-hash: 688dfc7685
    name: admission-webhook-k8s-688dfc7685
    namespace: nsm-system
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: admission-webhook-k8s
      uid: b93ae680-cc2c-4ec9-8fe8-98f9cd30942c
    resourceVersion: "954"
    uid: 919b1361-1b93-4cdd-be0d-1fa918a98c68
  spec:
    replicas: 1
    selector:
      matchLabels:
        app: admission-webhook-k8s
        pod-template-hash: 688dfc7685
    template:
      metadata:
        creationTimestamp: null
        labels:
          app: admission-webhook-k8s
          pod-template-hash: 688dfc7685
      spec:
        containers:
        - env:
          - name: SPIFFE_ENDPOINT_SOCKET
            value: unix:///run/spire/sockets/agent.sock
          - name: NSM_SERVICE_NAME
            value: admission-webhook-svc
          - name: NSM_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: NSM_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          - name: NSM_ANNOTATION
            value: networkservicemesh.io
          - name: NSM_CONTAINER_IMAGES
            value: ghcr.io/networkservicemesh/cmd-nsc:v1.7.0-rc.2
          - name: NSM_INIT_CONTAINER_IMAGES
            value: ghcr.io/networkservicemesh/cmd-nsc-init:v1.7.0-rc.2
          - name: NSM_LABELS
            value: spiffe.io/spiffe-id:true
          - name: NSM_ENVS
            value: NSM_LOG_LEVEL=TRACE
          image: ghcr.io/networkservicemesh/cmd-admission-webhook-k8s:v1.7.0-rc.2
          imagePullPolicy: IfNotPresent
          name: admission-webhook-k8s
          readinessProbe:
            failureThreshold: 3
            httpGet:
              path: /ready
              port: 443
              scheme: HTTPS
            periodSeconds: 10
            successThreshold: 1
            timeoutSeconds: 1
          resources: {}
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: admission-webhook-sa
        serviceAccountName: admission-webhook-sa
        terminationGracePeriodSeconds: 30
  status:
    availableReplicas: 1
    fullyLabeledReplicas: 1
    observedGeneration: 1
    readyReplicas: 1
    replicas: 1
- metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2022-12-21T23:41:10Z"
    generation: 1
    labels:
      app: nsmgr-proxy
      pod-template-hash: c874d5d87
      spiffe.io/spiffe-id: "true"
    name: nsmgr-proxy-c874d5d87
    namespace: nsm-system
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: nsmgr-proxy
      uid: e37d7dbc-77b7-4b24-ba8b-35100976e3ba
    resourceVersion: "1092"
    uid: 40275df1-f7b7-407e-8b3a-f48c5167188f
  spec:
    replicas: 1
    selector:
      matchLabels:
        app: nsmgr-proxy
        pod-template-hash: c874d5d87
    template:
      metadata:
        annotations:
          spiffe.io/federatesWith: nsm.cluster2
        creationTimestamp: null
        labels:
          app: nsmgr-proxy
          pod-template-hash: c874d5d87
          spiffe.io/spiffe-id: "true"
      spec:
        containers:
        - env:
          - name: SPIFFE_ENDPOINT_SOCKET
            value: unix:///run/spire/sockets/agent.sock
          - name: NSM_NAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.name
          - name: NSM_LOG_LEVEL
            value: TRACE
          - name: NSM_REGISTRY_URL
            value: registry:5002
          - name: NSM_REGISTRY_PROXY_URL
            value: registry-proxy:5005
          - name: NSM_LISTEN_ON
            value: tcp://:5004
          - name: NSM_IP
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: status.podIP
          - name: NSM_MAP_IP_FILE_PATH
            value: /etc/mapip/config.yaml
          image: ghcr.io/networkservicemesh/cmd-nsmgr-proxy:v1.7.0-rc.2
          imagePullPolicy: IfNotPresent
          name: nsmgr-proxy
          ports:
          - containerPort: 5004
            hostPort: 5004
            protocol: TCP
          resources:
            limits:
              cpu: 400m
              memory: 100Mi
            requests:
              cpu: 200m
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /run/spire/sockets
            name: spire-agent-socket
            readOnly: true
          - mountPath: /etc/mapip
            name: mapip-volume
        - env:
          - name: NSM_OUTPUTPATH
            value: /etc/mapip/config.yaml
          - name: NSM_NODENAME
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: spec.nodeName
          image: ghcr.io/networkservicemesh/cmd-map-ip-k8s:v1.7.0-rc.2
          imagePullPolicy: IfNotPresent
          name: map-ip-k8s
          resources:
            limits:
              cpu: 50m
              memory: 25Mi
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /etc/mapip
            name: mapip-volume
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: nsmgr-proxy-sa
        serviceAccountName: nsmgr-proxy-sa
        terminationGracePeriodSeconds: 30
        volumes:
        - hostPath:
            path: /run/spire/sockets
            type: Directory
          name: spire-agent-socket
        - hostPath:
            path: /var/lib/networkservicemesh
            type: DirectoryOrCreate
          name: nsm-socket
        - emptyDir: {}
          name: mapip-volume
  status:
    availableReplicas: 1
    fullyLabeledReplicas: 1
    observedGeneration: 1
    readyReplicas: 1
    replicas: 1
- metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2022-12-21T23:41:10Z"
    generation: 1
    labels:
      app: registry
      pod-template-hash: 679b68767c
      spiffe.io/spiffe-id: "true"
    name: registry-k8s-679b68767c
    namespace: nsm-system
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: registry-k8s
      uid: 3547f5ca-d828-4ada-b5eb-2ab8de83313d
    resourceVersion: "980"
    uid: 48d310d0-01b4-4fe4-b540-9a1aaba3d862
  spec:
    replicas: 1
    selector:
      matchLabels:
        app: registry
        pod-template-hash: 679b68767c
    template:
      metadata:
        annotations:
          spiffe.io/federatesWith: nsm.cluster2
        creationTimestamp: null
        labels:
          app: registry
          pod-template-hash: 679b68767c
          spiffe.io/spiffe-id: "true"
      spec:
        containers:
        - env:
          - name: SPIFFE_ENDPOINT_SOCKET
            value: unix:///run/spire/sockets/agent.sock
          - name: REGISTRY_K8S_NAMESPACE
            valueFrom:
              fieldRef:
                apiVersion: v1
                fieldPath: metadata.namespace
          - name: REGISTRY_K8S_LOG_LEVEL
            value: TRACE
          - name: REGISTRY_K8S_LISTEN_ON
            value: tcp://:5002
          - name: REGISTRY_K8S_PROXY_REGISTRY_URL
            value: nsmgr-proxy:5004
          image: ghcr.io/networkservicemesh/cmd-registry-k8s:v1.7.0-rc.2
          imagePullPolicy: IfNotPresent
          name: registry
          ports:
          - containerPort: 5002
            hostPort: 5002
            protocol: TCP
          resources:
            limits:
              cpu: 200m
              memory: 40Mi
            requests:
              cpu: 100m
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /run/spire/sockets
            name: spire-agent-socket
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        serviceAccount: registry-k8s-sa
        serviceAccountName: registry-k8s-sa
        terminationGracePeriodSeconds: 30
        volumes:
        - hostPath:
            path: /run/spire/sockets
            type: Directory
          name: spire-agent-socket
        - hostPath:
            path: /var/lib/networkservicemesh
            type: DirectoryOrCreate
          name: nsm-socket
  status:
    availableReplicas: 1
    fullyLabeledReplicas: 1
    observedGeneration: 1
    readyReplicas: 1
    replicas: 1
- metadata:
    annotations:
      deployment.kubernetes.io/desired-replicas: "1"
      deployment.kubernetes.io/max-replicas: "2"
      deployment.kubernetes.io/revision: "1"
    creationTimestamp: "2022-12-21T23:41:10Z"
    generation: 1
    labels:
      app: registry-proxy
      pod-template-hash: 5d4487556b
      spiffe.io/spiffe-id: "true"
    name: registry-proxy-5d4487556b
    namespace: nsm-system
    ownerReferences:
    - apiVersion: apps/v1
      blockOwnerDeletion: true
      controller: true
      kind: Deployment
      name: registry-proxy
      uid: 71bbdb6b-156c-48f9-b2bc-fb6fab51ca59
    resourceVersion: "1001"
    uid: c7a7412f-5465-40cf-b494-3c6b3690a402
  spec:
    replicas: 1
    selector:
      matchLabels:
        app: registry-proxy
        pod-template-hash: 5d4487556b
    template:
      metadata:
        annotations:
          spiffe.io/federatesWith: nsm.cluster2
        creationTimestamp: null
        labels:
          app: registry-proxy
          pod-template-hash: 5d4487556b
          spiffe.io/spiffe-id: "true"
      spec:
        containers:
        - env:
          - name: SPIFFE_ENDPOINT_SOCKET
            value: unix:///run/spire/sockets/agent.sock
          - name: NSM_LISTEN_ON
            value: tcp://:5005
          - name: NSM_LOG_LEVEL
            value: TRACE
          image: ghcr.io/networkservicemesh/cmd-registry-proxy-dns:v1.7.0-rc.2
          imagePullPolicy: IfNotPresent
          name: registry
          ports:
          - containerPort: 5005
            hostPort: 5005
            protocol: TCP
          resources:
            limits:
              cpu: 200m
              memory: 40Mi
            requests:
              cpu: 100m
          terminationMessagePath: /dev/termination-log
          terminationMessagePolicy: File
          volumeMounts:
          - mountPath: /run/spire/sockets
            name: spire-agent-socket
        dnsPolicy: ClusterFirst
        restartPolicy: Always
        schedulerName: default-scheduler
        securityContext: {}
        terminationGracePeriodSeconds: 30
        volumes:
        - hostPath:
            path: /run/spire/sockets
            type: Directory
          name: spire-agent-socket
        - hostPath:
            path: /var/lib/networkservicemesh
            type: DirectoryOrCreate
          name: nsm-socket
  status:
    availableReplicas: 1
    fullyLabeledReplicas: 1
    observedGeneration: 1
    readyReplicas: 1
    replicas: 1
kind: ReplicaSetList
metadata:
  resourceVersion: "5265"
